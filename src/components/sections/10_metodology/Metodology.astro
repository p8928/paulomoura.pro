---
import './css/metodology.css';
---

<header class="metodology-hero">
  <div class="metodology-header">
    <h1 class="metodology-title">
      <span class="title-brand">Brand</span>
      <svg class="title-dash" viewBox="0 0 80 10" xmlns="http://www.w3.org/2000/svg"><rect width="80" height="10" fill="#C0B283"/></svg>
      <span class="title-led">Led</span>
    </h1>
  </div>
</header>

<main class="metodology-main-content">
  <div class="shape shape-1"></div>
  <div class="shape shape-2"></div>

  <div class="metodology-grid-content">
    <h2 class="metodology-subtitle animate-fade-in">FAÇA SEU BRANDING TRABALHAR POR VOCÊ</h2>

    <p class="metodology-paragraph animate-fade-in">
      Você pode encontrar qualquer profissional ou agência que crie um site, publique conteúdo e gerencie SEO adotando abordagem genérica — acontece que sua empresa não é algo qualquer. Uma comunicação digital coesa requer um olhar profundo sobre os valores, características e virtudes da sua marca.
    </p>

    <blockquote class="metodology-blockquote animate-pull-quote">
      "Em vez de apenas corresponder suas palavras-chave a páginas da web, o Google quer entender do que você realmente necessita com base em quem você é e o que, como indivíduo, precisa no momento. O Google chama isso de contexto pessoal."
      <cite class="metodology-cite">Eli Schwartz — Autor e criador do conceito Product-Led SEO</cite>
    </blockquote>

    <div class="metodology-final-grid">
      <p class="metodology-paragraph animate-fade-in">
        O Google compreende nossas preferências à medida em que pesquisamos, clicamos ou avaliamos, por exemplo. Isso significa que o algoritmo — a cada dia mais calibrado — sabe quando a sua empresa é recomendação adequada ao contexto do usuário.
      </p>
      <p class="metodology-paragraph animate-fade-in">
        Quanto mais complexidade esse contexto adquire, maior a quantidade de critérios que determinarão o resultado da pesquisa e, consequentemente, melhores serão as recomendações. O melhor disso tudo é que os benefícios não se limitam ao usuário: a sua marca também tem muito a ganhar, contanto que entenda o jogo.
      </p>
    </div>
  </div>
</main>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  function initAnimations() {
    // Limpar triggers anteriores para evitar duplicação
    ScrollTrigger.getAll().forEach(trigger => trigger.kill());

    // Coreografia do Título
    const tl = gsap.timeline({ delay: 0.2 });
    tl.from(".title-brand", { x: -50, opacity: 0, duration: 1, ease: "power3.out" })
      .from(".title-led", { x: 50, opacity: 0, duration: 1, ease: "power3.out" }, "-=0.8")
      .from(".title-dash rect", { scaleX: 0, transformOrigin: "center", duration: 0.8, ease: "power3.inOut" }, "-=0.8");

    // Animação de Parallax para as formas
    gsap.to(".shape-1", {
      y: -150,
      ease: "none",
      scrollTrigger: {
        trigger: ".metodology-main-content",
        start: "top bottom",
        end: "bottom top",
        scrub: 0.4,
      },
    });

    gsap.to(".shape-2", {
      y: 200,
      ease: "none",
      scrollTrigger: {
        trigger: ".metodology-main-content",
        start: "top bottom",
        end: "bottom top",
        scrub: 0.6,
      },
    });

    // Animação de Fade-in para os textos
    const fadeElements = document.querySelectorAll(".animate-fade-in");
    fadeElements.forEach(el => {
      gsap.fromTo(el,
        { opacity: 0, y: 30 },
        {
          opacity: 1,
          y: 0,
          duration: 1,
          ease: "power3.out",
          scrollTrigger: {
            trigger: el,
            start: "top 85%",
            toggleActions: "play none none none",
          }
        }
      );
    });

    // Animação para o Pull Quote
    const blockquote = document.querySelector('.animate-pull-quote');
    if (blockquote) {
      gsap.from(blockquote, {
        opacity: 0,
        scale: 0.95,
        duration: 1.2,
        ease: "power4.out",
        scrollTrigger: {
          trigger: blockquote,
          start: "top 80%",
          toggleActions: "play none none none",
        }
      });
    }
  }

  // Executar na carga inicial da página
  document.addEventListener('DOMContentLoaded', initAnimations);

  // Executar em navegações subsequentes do Astro
  document.addEventListener('astro:page-load', initAnimations);
  
  // Limpar os ScrollTriggers ao sair da página (importante para navegação do Astro)
  document.addEventListener('astro:before-swap', () => {
    ScrollTrigger.getAll().forEach(trigger => trigger.kill());
  });
</script>
