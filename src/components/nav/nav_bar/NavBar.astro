---
import './css/nav_bar.css';
import Menu from '../overlay_menu/Menu.astro';
---

  <header class="hero__header">
    <div class="hero__logo">
      <a href="/">
        <img src="/img/logo/main_logo_black.svg" alt="Logo Moura">
      </a>
    </div>
    

    
    <!-- Hamburger Menu Button (only visible on mobile) -->
    <button class="hero__menu-btn" id="mobileMenuBtn" aria-label="Abrir menu">
      <div class="hero__menu-lines">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </button>
    
    <nav class="hero__nav">
      <a href="/about" class="hero__nav-link about-link desktop-only">Sobre</a>
      
      <a href="/servicos" class="hero__nav-link services-link blog-link">Serviços</a>
      
      <a href="/blog" class="hero__nav-link blog-link">Blog</a>
      
      <a href="/contato" 
         class="hero__nav-link contact desktop-only">
        Contato
      </a>
      
      <!-- Language selector moved to the end of the navigation -->
      <div class="hero__language-selector">
        <button class="hero__language-btn" id="languageBtn" aria-label="Selecionar idioma">
          <span id="currentLanguage">pt-BR</span>
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="margin-left: 4px;">
            <polyline points="6 9 12 15 18 9"></polyline>
          </svg>
        </button>
        
        <div class="hero__language-dropdown" id="languageDropdown">
          <a href="#" class="hero__language-option" data-lang="pt" data-text="pt-BR">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="15" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid slice" fill="none" style="margin-right: 8px;">
              <path fill="var(--flag-palette-green, #6da544)" d="M512 512H0V0h512z"/>
              <path fill="var(--flag-palette-yellow, #ffda44)" d="M467.5 256 256 411.8 44.5 256 256 100.2z"/>
              <path fill="var(--flag-palette-white, #eeeeee)" d="M256 167a89 89 0 1 1 0 178 89 89 0 0 1 0-178"/>
              <path fill="var(--flag-palette-blue, #0052b4)" d="M211.5 250.4a150 150 0 0 1 117.4 56.7 89 89 0 0 1-162-50q21.2-6.6 44.6-6.7M256 167a89 89 0 0 1 87.4 106 183 183 0 0 0-169.2-52 89 89 0 0 1 81.8-54"/>
            </svg>
            <span>Português</span>
          </a>
          <a href="#" class="hero__language-option" data-lang="en" data-text="en-UK">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="15" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid slice" fill="none" style="margin-right: 8px;">
              <path fill="var(--flag-palette-blue, #0052b4)" d="M0 0h512v512H0z"/>
              <path fill="var(--flag-palette-white, #eeeeee)" d="M464 512h48v-48L304 256 512 48V0h-48L256 208 48 0H0v48l208 208L0 464v48h48l208-208z"/>
              <path fill="var(--flag-palette-white, #eeeeee)" d="M512 320V192H320V0H192v192H0v128h192v192h64V320z"/>
              <path fill="var(--flag-palette-bright-red, #d80027)" d="M512 288v-64H288V0h-64v224H0v64h224v224h64V288z"/>
              <path fill="var(--flag-palette-bright-red, #d80027)" d="M0 32V0l192 192h-32zm512 448v32L320 320h32zM32 512H0l192-192v32zM480 0h32L320 192v-32z"/>
            </svg>
            <span>English</span>
          </a>
          <a href="#" class="hero__language-option" data-lang="es" data-text="es-ES">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="15" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid slice" fill="none" style="margin-right: 8px;">
              <path fill="var(--flag-palette-yellow, #ffda44)" d="M512 384H0V128h512z"/>
              <path fill="var(--flag-palette-bright-red, #d80027)" d="M512 512H0V368h512zm0-368H0V0h512z"/>
              <path fill="var(--flag-palette-white, #eeeeee)" d="M144 304h-16v-80h16zm128 0h16v-80h-16z"/>
              <path fill="var(--flag-palette-bright-red, #d80027)" d="M122 248a4 4 0 1 0 0 8h172a4 4 0 1 0 0-8zm0 24a4 4 0 1 0 0 8h28a4 4 0 1 0 0-8zm144 0a4 4 0 1 0 0 8h28a4 4 0 1 0 0-8z"/>
              <path fill="var(--flag-palette-white, #eeeeee)" d="M256 272h-16.3c10 5.9 16.3 14.4 16.3 24 0 17.7-21.5 32-48 32s-48-14.3-48-32 21.5-32 48-32v-40h48zm-60-104q7.5 0 12 6a16 16 0 0 1 27 5 16 16 0 1 1-10 20 16 16 0 0 1-17-4 16 16 0 0 1-17 4c-2 7-8 11-15 11-9 0-16-7-16-16s7-16 16-16l5 1c2-6 8-11 15-11m-20 18c-4 0-8 4-8 8 0 5 4 8 8 8s8-3 8-7l-4-8zm60 1-4 8c0 4 4 7 8 7 5 0 8-3 8-8 0-4-3-8-8-8m-40-11c-4 0-8 4-8 8 0 5 4 8 8 8 5 0 8-3 8-8 0-4-3-8-8-8m24 0c-4 0-8 4-8 8 0 5 4 8 8 8 5 0 8-3 8-8 0-4-3-8-8-8"/>
              <path fill="var(--flag-palette-gold, #ff9811)" d="M200 160h16v32h-16z"/>
              <path fill="var(--flag-palette-bright-red, #d80027)" d="M256 296a24 24 0 1 1-48 0v-24h48zm-48-24h-48v-48h48zm24-40a10 10 0 0 1 10 10v12a10 10 0 1 1-20 0v-12a10 10 0 0 1 10-10m-96-40a8 8 0 0 1 8 8v8a8 8 0 0 1-16 0v-8a8 8 0 0 1 8-8m72-8c22 0 40 11 40 24l-8 8h-64l-8-8c0-13 18-24 40-24m72 8a8 8 0 0 1 8 8v8a8 8 0 0 1-16 0v-8a8 8 0 0 1 8-8"/>
              <path fill="var(--flag-palette-gold, #ff9811)" d="M144 304a8 8 0 0 1 0 16h-16a8 8 0 0 1 0-16zm144 0a8 8 0 0 1 0 16h-16a8 8 0 0 1 0-16zm-114-24 5-8h10l5 8 5-8h9v24c0 8-3 14-9 19l-5-6-5 10a21 21 0 0 1-10 0l-5-10-5 6c-5-5-9-11-9-19v-24h9zm26-48v8h-8v16h8v8h-32v-8h8v-16h-8v-8zm-56-24a8 8 0 0 1 0 16h-16a8 8 0 0 1 0-16zm96 16h-64v-8h64zm48-16a8 8 0 0 1 0 16h-16a8 8 0 0 1 0-16z"/>
              <path fill="var(--flag-palette-bright-red, #d80027)" d="M169 272v43q4.6 3 10 4v-47zm20 0v47q5.4-1 10-4v-43z"/>
              <path fill="var(--flag-palette-yellow, #ffda44)" d="M186 196a6 6 0 1 1 0 12 6 6 0 0 1 0-12m22 0a6 6 0 1 1 0 12 6 6 0 0 1 0-12m22 0a6 6 0 1 1 0 12 6 6 0 0 1 0-12"/>
              <path fill="var(--flag-palette-blue, #0052b4)" d="M144 320a8 8 0 0 1 0 16h-16a8 8 0 0 1 0-16zm144 0a8 8 0 0 1 0 16h-16a8 8 0 0 1 0-16zm-80-64a16 16 0 1 1 0 32 16 16 0 0 1 0-32"/>
            </svg>
            <span>Español</span>
          </a>
        </div>
      </div>
    </nav>
    
<Menu />
  </header>

  <script is:inline>
    document.addEventListener('DOMContentLoaded', function() {
      const languageBtn = document.getElementById('languageBtn');
      const languageDropdown = document.getElementById('languageDropdown');
      const currentLanguage = document.getElementById('currentLanguage');
      const languageOptions = document.querySelectorAll('.hero__language-option');
      
      // Initialize with Portuguese as default
      const defaultLanguage = 'pt';
      
      // Set initial language from localStorage or default
      const savedLanguage = localStorage.getItem('selectedLanguage') || defaultLanguage;
      
      // Set active language on page load
      setActiveLanguage(savedLanguage);
      
      // Add click event to language button to toggle dropdown
      languageBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        languageDropdown.classList.toggle('show');
      });
      
      // Close language dropdown when clicking outside
      document.addEventListener('click', function(e) {
        if (!languageBtn.contains(e.target) && !languageDropdown.contains(e.target)) {
          closeDropdown();
        }
      });
      
      // Close dropdown on ESC key
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
          closeDropdown();
        }
      });
      
      // Handle language selection
      languageOptions.forEach(option => {
        option.addEventListener('click', function(e) {
          e.preventDefault();
          const lang = this.getAttribute('data-lang');
          setActiveLanguage(lang);
          closeDropdown();
        });
      });
      
      // Set active language
      function setActiveLanguage(lang) {
        const selectedOption = document.querySelector(`.hero__language-option[data-lang="${lang}"]`);
        if (selectedOption) {
          const text = selectedOption.getAttribute('data-text');
          
          // Update current language display
          currentLanguage.textContent = text;
          
          // Update active state
          languageOptions.forEach(option => {
            option.classList.toggle('active', option.getAttribute('data-lang') === lang);
          });
          
          // Save to localStorage
          localStorage.setItem('selectedLanguage', lang);
          localStorage.setItem('userLanguage', lang);
        }
      }
      
      function closeDropdown() {
        languageDropdown.classList.remove('show');
      }
    });
    

    
    const mobileMenuBtn = document.getElementById('mobileMenuBtn');
    const overlayMenu = document.getElementById('overlayMenu');
    const closeMenuBtn = document.getElementById('closeMenuBtn');

    mobileMenuBtn.addEventListener('click', () => {
      overlayMenu.classList.add('open');
      document.body.classList.add('overlay-open');
    });

    closeMenuBtn.addEventListener('click', () => {
      overlayMenu.classList.remove('open');
      document.body.classList.remove('overlay-open');
    });
  </script>
